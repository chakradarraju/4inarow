(this.webpackJsonp4inarow=this.webpackJsonp4inarow||[]).push([[0],{13:function(e,n,t){e.exports=t(31)},18:function(e,n,t){},19:function(e,n,t){},20:function(e,n,t){},21:function(e,n,t){},30:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=30},31:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(11),l=t.n(o),c=(t(18),t(8)),i=t(1),s=(t(19),t(7));t(20);var u=function(e){var n=e.enable?{onMouseEnter:e.onHover,onClick:e.onClick}:{};return a.a.createElement("div",Object.assign({},n,{className:"cell "+e.type}))};var m=function(e){var n=function(n){return function(){return e.onHover(n)}},t=function(n){return function(){return e.onClick(n)}};return e.cells.map((function(r,o){return a.a.createElement("div",{key:o},r.map((function(r,o){return a.a.createElement(u,{type:r,key:o,enable:e.enable,onClick:t(o),onHover:n(o)})})))}))},p=(t(21),t(5)),f=t(6),g=function(){function e(){Object(p.a)(this,e),this.reset()}return Object(f.a)(e,[{key:"reset",value:function(){this.n=0,this.c=""}},{key:"count",value:function(e){if(this.c===e){if(this.n++,4===this.n)return!0}else this.c=e,this.n=1;return!1}},{key:"currentColor",value:function(){return this.c}}]),e}();var y=function(e){for(var n=e.length,t=e[0].length,r=new g,a=0,o=0;o<n;o++){r.reset();for(var l=0;l<t;l++)if("e"===e[o][l])a++,r.reset();else if(r.count(e[o][l]))return r.currentColor()}if(0===a)return"tie";for(l=0;l<t;l++){r.reset();for(o=0;o<n;o++)if("e"!==e[o][l]){if(r.count(e[o][l]))return r.currentColor()}else r.reset()}for(var c=0;c<n+t;c++){r.reset();for(o=0;o<n;o++){var i=c-o;if(!(i<0||i>=t))if("e"!==e[o][i]){if(r.count(e[o][i]))return r.currentColor()}else r.reset()}}for(c=-n;c<t;c++){r.reset();for(o=0;o<n;o++){var s=c+o;if(!(s<0||s>=t))if("e"!==e[o][s]){if(r.count(e[o][s]))return r.currentColor()}else r.reset()}}return null};var h=function(e){var n=Object(s.a)(Array(7)).map((function(e){return new Array(7).fill("e")})),t=Object(r.useState)(n),o=Object(i.a)(t,2),l=o[0],c=o[1],p=Object(r.useState)(e.player1),f=Object(i.a)(p,2),g=f[0],h=f[1],v=Object(r.useState)(!1),d=Object(i.a)(v,2),b=d[0],E=d[1],O=e.player1Local!==e.player2Local;function j(){for(var e=w(g)+"l",n=0;n<7;n++)for(var t=0;t<7;t++)l[n][t]===e&&(l[n][t]="e")}function C(e){for(var n=6;"e"!==l[n][e]&&n>0;)n--;return n}function k(n,t){l[n][t]=w(g),c(l.slice());var r=y(l);null!==r&&("tie"!==r&&(r=("b"===r?e.player1:e.player2)+" won"),alert(r),E(!0));var a=g===e.player1?e.player2:e.player1;h(a)}function w(n){return n===e.player1?"b":"r"}return Object(r.useEffect)((function(){return e.player1Local||e.messenger.on("player1-select",(function(e){return k(e.i,e.j)})),e.player2Local||e.messenger.on("player2-select",(function(e){return k(e.i,e.j)})),function(){e.player1Local||e.messenger.off("player1-select"),e.player2Local||e.messenger.off("player2-select")}}),[g]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"users"},a.a.createElement("span",{className:"you"},a.a.createElement(u,{type:"b"}),e.player1),a.a.createElement("span",{className:"opponent"},e.player2,a.a.createElement(u,{type:"r"}))),a.a.createElement("div",{className:"message"},g," turn"),a.a.createElement("button",{onClick:e.onExit},"Exit"),a.a.createElement("div",{style:{margin:"30px"}},a.a.createElement(m,{enable:!b&&(g===e.player1&&e.player1Local||g===e.player2&&e.player2Local),cells:l,onHover:function(e){j();var n=C(e);n<0||(l[n][e]=w(g)+"l",c(l.slice()))},onClick:function(n){j();var t=C(n);t<0?console.log("Column does not have empty cell"):(O&&e.messenger.send((g===e.player1?"player1":"player2")+"-select",{i:t,j:n}),k(t,n))}})))},v=t(10);var d=function(e){var n=Object(r.useState)(!C()),t=Object(i.a)(n,2),o=t[0],l=t[1],c=Object(r.useState)(!0),s=Object(i.a)(c,2),u=s[0],m=s[1],p=Object(r.useState)(!1),f=Object(i.a)(p,2),g=f[0],y=f[1],h=Object(r.useState)(!1),d=Object(i.a)(h,2),b=d[0],E=d[1],O=Object(r.useRef)(),j=window.location+"#"+function(){var n=v.generate();return e.messenger.id+"/"+n}();function C(){return window.location.hash&&window.location.hash.length>0}function k(){y(!0),l(!1),e.messenger.send("player1-name",e.player1),e.messenger.send("player2-name",e.player2)}return Object(r.useEffect)((function(){e.messenger.signaling?E(!0):e.messenger.on("signaling-change",(function(n,t){if(E(n),n){if(console.log("signaling ready",t),C()){m(!1);var r=function(e){console.log("Parsing game str",e);var n=e.split("/");return 2===n.length?n:[null,null]}(window.location.hash.substr(1)),a=Object(i.a)(r,2),o=a[0];a[1];if(null===o)return void console.log("Invalid game str");e.messenger.connect(o,{metadata:{peerId:e.messenger.id},reliable:!0}),e.messenger.on("player1-name",(function(n){return e.setPlayer1(n)}))}else m(!0),e.messenger.expectConnect(),e.messenger.on("player2-name",(function(n){return e.setPlayer2(n)}));e.messenger.peerConnected?k():e.messenger.on("peer-connected",k)}}))}),[]),Object(r.useEffect)((function(){e.messenger.send("player1-name",e.player1)}),[e.player1]),Object(r.useEffect)((function(){e.messenger.send("player2-name",e.player2)}),[e.player2]),a.a.createElement("div",{style:{margin:"30px"}},a.a.createElement("div",{style:{margin:"30px"}},a.a.createElement("button",{style:{padding:o?"5px":""},onClick:function(){return l(!0)}},"Local game"),a.a.createElement("button",{style:{padding:o?"":"5px"},onClick:function(){return l(!1)}},"Network game")),o&&a.a.createElement(a.a.Fragment,null,"Update your names and hit start to play!",a.a.createElement("br",null),a.a.createElement("br",null),"Player 1: ",e.player1,a.a.createElement("button",{onClick:function(){return e.setPlayer1(prompt("Player 1 name"))}},"Change"),a.a.createElement("br",null),"Player 2: ",e.player2,a.a.createElement("button",{onClick:function(){return e.setPlayer2(prompt("Player 2 name"))}},"Change"),a.a.createElement("br",null),a.a.createElement("button",{style:{margin:"30px"},onClick:e.onStart},"Start")),!o&&a.a.createElement(a.a.Fragment,null,!b&&a.a.createElement("div",null,"Connecting to server..."),b&&u&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{margin:"20px"}},a.a.createElement("div",null,"Name: ",e.player1,a.a.createElement("button",{onClick:function(){return e.setPlayer1(prompt("Your name"))}},"Change")),a.a.createElement("div",null,"Opponent name: ",e.player2)),!g&&a.a.createElement(a.a.Fragment,null,"Ask your friend to open:",a.a.createElement("br",null),a.a.createElement("input",{ref:O,readOnly:!0,value:j}),a.a.createElement("button",{onClick:function(){O&&O.current&&(O.current.select(),document.execCommand("copy"),alert("Copied, now send it to your friend"))}},"Copy"),a.a.createElement("div",null,"Waiting for peer..."))),b&&!u&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{margin:"20px"}},a.a.createElement("div",null,"Name: ",e.player2,a.a.createElement("button",{onClick:function(){return e.setPlayer2(prompt("Your name"))}},"Change")),a.a.createElement("div",null,"Opponent name: ",e.player1)),!g&&a.a.createElement(a.a.Fragment,null,"Connecting to host...")),g&&a.a.createElement("button",{onClick:function(){e.setPlayer1Local(u),e.setPlayer2Local(!u),e.onStart()}},"Start")))},b=t(12),E=t.n(b),O=t(10),j=new(function(){function e(){Object(p.a)(this,e),console.log("Starting messenger");var n=localStorage.getItem("client-id");n||(n=O.generate()),localStorage.setItem("client-id",n),console.log("client id",n),this.id=n;var t={secure:"https:"===window.location.protocol};console.log("peer opts",t),this.peer=new E.a(n,t),window.messenger=this,this.signaling=null,this.connection=null,this.peer.on("open",this.onSignalingOpen.bind(this)),this.peer.on("error",console.error),this.peerConnection=!1,this.eventListeners={},this.queue=[]}return Object(f.a)(e,[{key:"connect",value:function(e,n){console.log("connecting to host",e),this.setConnection(this.peer.connect(e,n))}},{key:"expectConnect",value:function(){console.log("Looking for connection"),this.peer.on("connection",this.setConnection.bind(this))}},{key:"onSignalingOpen",value:function(e){this.signaling=!0,this.trigger("signaling-change",[!0,e])}},{key:"onSignalingError",value:function(e){this.signaling=!1,console.error(e),this.trigger("signaling-change",[!1])}},{key:"isSignalingConnected",value:function(){return this.signaling}},{key:"setConnection",value:function(e){console.log("Setting up connection",e),this.connection=e,this.connection.on("open",this.onPeerConnected.bind(this)),this.connection.on("data",this.onData.bind(this)),this.connection.on("error",console.error)}},{key:"trigger",value:function(e,n){var t=this.eventListeners[e];t&&t.forEach((function(e){return e.apply(void 0,Object(s.a)(n))}))}},{key:"on",value:function(e,n){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(n)}},{key:"off",value:function(e){delete this.eventListeners[e]}},{key:"onPeerConnected",value:function(){this.peerConnection=!0,this.trigger("peer-connected",[!0]);for(var e=0;e<this.queue.length;e++)this.connection.send(this.queue[e]);this.queue=[]}},{key:"send",value:function(e,n){var t={type:e,data:n};this.peerConnection?this.connection.send(t):this.queue.push(t)}},{key:"onData",value:function(e){console.log("got message",e),e.type&&this.trigger(e.type,[e.data])}}]),e}());var C=function(){var e,n=Object(r.useState)(!1),t=Object(i.a)(n,2),o=t[0],l=t[1],s=Object(r.useState)("Player 1"),u=Object(i.a)(s,2),m=u[0],p=u[1],f=Object(r.useState)("Player 2"),g=Object(i.a)(f,2),y=g[0],v=g[1],b=Object(r.useState)(!0),E=Object(i.a)(b,2),O=E[0],C=E[1],k=Object(r.useState)(!0),w=Object(i.a)(k,2),S=w[0],L=w[1];return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"title"},"4 IN A ROW"),a.a.createElement("div",null,!o&&a.a.createElement(d,(e={messenger:j,player1:m,player2:y,setPlayer1:p,setPlayer2:v,onStart:function(){return l(!0)}},Object(c.a)(e,"messenger",j),Object(c.a)(e,"setPlayer1Local",C),Object(c.a)(e,"setPlayer2Local",L),e)),o&&a.a.createElement(h,{player1:m,player2:y,player1Local:O,player2Local:S,onExit:function(){return l(!1)},messenger:j})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.b27f230e.chunk.js.map